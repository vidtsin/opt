<?xml version="1.0" encoding="utf-8"?>
<odoo>

        <!-- Opportunities by user and team pivot View -->
        <record id="crm_local_opportunity_custom_report_view_pivot" model="ir.ui.view">
            <field name="name">crm.local.opportunity.custom.report.pivot</field>
            <field name="model">crm.opportunity.custom.report</field>
            <field name="arch" type="xml">
                <pivot string="Pipeline Analysis(Local)" disable_linking="True">
                    <field name="create_date" interval="month" type="col"/>
                    <field name="stage_id" type="row"/>
                    <field name="num_of_leads" type="measure"/>
                </pivot>
            </field>
        </record>



        <!-- Opportunities by user and team Graph View -->
        <record id="crm_local_opportunity_custom_report_view_graph" model="ir.ui.view">
            <field name="name">crm.local.opportunity.custom.report.graph</field>
            <field name="model">crm.opportunity.custom.report</field>
            <field name="arch" type="xml">
                <graph string="Pipeline Analysis(Local)" stacked="True">
                    <field name="stage_id" type="row"/>
                    <field name="create_date" type="row" interval="month"/>
                    <field name="num_of_leads" type="measure"/>
                </graph>
            </field>
        </record>




        <!-- Opportunities by user and team Search View -->
        <record id="crm_local_opportunity_custom_report_view_search" model="ir.ui.view">
            <field name="name">crm.local.opportunity.custom.report.select</field>
            <field name="model">crm.opportunity.custom.report</field>
            <field name="arch" type="xml">
                <search string="Opportunities Analysis">
                    <filter string="My Opportunities" name="my"
                            domain="[('user_id', '=', uid)]"/>
                    <separator/>
                    <filter name="lead" string="Lead" domain="[('type','=', 'lead')]" help="Show only lead"/>
                    <filter name="opportunity" string="Opportunity" domain="[('type','=','opportunity')]" help="Show only opportunity"/>
                    <separator/>
                    <field name="user_id" string="Salesperson"/>
                    <separator/>
                    <group expand="0" string="Extended Filters">
                        <field name="stage_id" domain="['|', ('team_id', '=', False), ('team_id', '=', 'team_id')]"/>
                        <separator orientation="vertical"/>
                        <field name="stage_id" widget="selection" domain="['|', ('team_id', '=', False), ('team_id', '=', 'team_id')]"/>
                        <separator orientation="vertical"/>
                    </group>
                    <group expand="1" string="Group By">
                        <filter string="Salesperson" context="{'group_by':'user_id'}" />
                        <filter string="Stage" context="{'group_by':'stage_id'}"/>
                        <separator orientation="vertical" />
                        <filter string="Creation Month" context="{'group_by':'create_date:month'}" name="month"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="crm_local_opportunity_custom_report_action" model="ir.actions.act_window">
             <field name="name">Pipeline Analysis(Local)</field>
             <field name="res_model">crm.opportunity.custom.report</field>
             <field name="view_type">form</field>
             <field name="view_mode">pivot,graph</field>
            <field name="domain">[('team_id.name','ilike','local')]</field>
             <field name="context">{}</field>
            <field name="view_ids"
                   eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'pivot', 'view_id': ref('crm_local_opportunity_custom_report_view_pivot')}),
                          (0, 0, {'view_mode': 'graph', 'view_id': ref('crm_local_opportunity_custom_report_view_graph')})]"/>
             <field name="help">Pipeline Analysis gives you an instant access to
your opportunities with information such as the expected revenue, planned cost,
missed deadlines or the number of interactions per opportunity. This report is
mainly used by the sales manager in order to do the periodic review with the
teams of the sales pipeline.</field>
        </record>
        <menuitem id="crm_local_opportunity_custom_report_menu" name="Pipeline(Local)"
            parent="sales_team.menu_sale_report" action="crm_local_opportunity_custom_report_action" sequence="10"/>

    <!--international report-->
        <!-- Opportunities by user and team pivot View -->
        <record id="crm_international_opportunity_custom_report_view_pivot" model="ir.ui.view">
            <field name="name">crm.international.opportunity.custom.report.pivot</field>
            <field name="model">crm.opportunity.custom.report</field>
            <field name="arch" type="xml">
                <pivot string="Pipeline Analysis(International)" disable_linking="True">
                    <field name="create_date" interval="month" type="col"/>
                    <field name="stage_id" type="row"/>
                    <field name="num_of_leads" type="measure"/>
                </pivot>
            </field>
        </record>



        <!-- Opportunities by user and team Graph View -->
        <record id="crm_international_opportunity_custom_report_view_graph" model="ir.ui.view">
            <field name="name">crm.international.opportunity.custom.report.graph</field>
            <field name="model">crm.opportunity.custom.report</field>
            <field name="arch" type="xml">
                <graph string="Pipeline Analysis(International)" stacked="True">
                    <field name="stage_id" type="row"/>
                    <field name="create_date" type="row" interval="month"/>
                    <field name="num_of_leads" type="measure"/>
                </graph>
            </field>
        </record>




        <!-- Opportunities by user and team Search View -->
        <record id="crm_international_opportunity_custom_report_view_search" model="ir.ui.view">
            <field name="name">crm.international.opportunity.custom.report.select</field>
            <field name="model">crm.opportunity.custom.report</field>
            <field name="arch" type="xml">
                <search string="Opportunities Analysis">
                    <filter string="My Opportunities" name="my"
                            domain="[('user_id', '=', uid)]"/>
                    <separator/>
                    <filter name="lead" string="Lead" domain="[('type','=', 'lead')]" help="Show only lead"/>
                    <filter name="opportunity" string="Opportunity" domain="[('type','=','opportunity')]" help="Show only opportunity"/>
                    <separator/>
                    <field name="user_id" string="Salesperson"/>
                    <separator/>
                    <group expand="0" string="Extended Filters">
                        <field name="stage_id" domain="['|', ('team_id', '=', False), ('team_id', '=', 'team_id')]"/>
                        <separator orientation="vertical"/>
                        <field name="stage_id" widget="selection" domain="['|', ('team_id', '=', False), ('team_id', '=', 'team_id')]"/>
                        <separator orientation="vertical"/>
                    </group>
                    <group expand="1" string="Group By">
                        <filter string="Salesperson" context="{'group_by':'user_id'}" />
                        <filter string="Stage" context="{'group_by':'stage_id'}"/>
                        <separator orientation="vertical" />
                        <filter string="Creation Month" context="{'group_by':'create_date:month'}" name="month"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="crm_international_opportunity_custom_report_action" model="ir.actions.act_window">
             <field name="name">Pipeline Analysis(International)</field>
             <field name="res_model">crm.opportunity.custom.report</field>
             <field name="view_type">form</field>
             <field name="view_mode">pivot,graph</field>
            <field name="domain">[('team_id.name','ilike','international')]</field>
             <field name="context">{}</field>
            <field name="view_ids"
                   eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'pivot', 'view_id': ref('crm_international_opportunity_custom_report_view_pivot')}),
                          (0, 0, {'view_mode': 'graph', 'view_id': ref('crm_international_opportunity_custom_report_view_graph')})]"/>
             <field name="help">Pipeline Analysis gives you an instant access to
your opportunities with information such as the expected revenue, planned cost,
missed deadlines or the number of interactions per opportunity. This report is
mainly used by the sales manager in order to do the periodic review with the
teams of the sales pipeline.</field>
        </record>
        <menuitem id="crm_international_opportunity_custom_report_menu" name="Pipeline(International)"
            parent="sales_team.menu_sale_report" action="crm_international_opportunity_custom_report_action" sequence="11"/>
</odoo>
